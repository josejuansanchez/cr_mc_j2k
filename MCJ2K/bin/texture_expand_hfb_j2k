#!/usr/bin/python
# -*- coding: iso-8859-15 -*-

import sys
import os
import display
import getopt

file = ""
layers = 3
pictures = 33
temporal_levels = 6

def usage():
    sys.stderr.write("+-----------------------------+\n")
    sys.stderr.write("| MCTF texture_expand_hfb_j2k |\n")
    sys.stderr.write("+-----------------------------+\n")
    sys.stderr.write("\n")
    sys.stderr.write("  Description:\n")
    sys.stderr.write("   Expand the HFB texture data.\n")
    sys.stderr.write("\n")
    sys.stderr.write("  Parameters:\n")
    sys.stderr.write("\n")
    sys.stderr.write("   -[-f]ile = file that contains the HFB data (\"%s\")\n" % file)
    sys.stderr.write("   -[-l]layers = number of quality layers to decode (%d)\n" % layers)
    sys.stderr.write("   -[-p]ictures = number of images to process (%d)\n" % pictures)
    sys.stderr.write("   -[-t]emporal_levels = number of temporal levels (%d)\n" % temporal_levels)
    sys.stderr.write("\n")

opts = ""



try:
    opts, extraparams = getopt.getopt(sys.argv[1:],
                                      "f:l:p:t:h",
                                      ["file=",
                                       "layers=",
                                       "pictures=",
                                       "temporal_levels=",
                                       "help"
                                       ])
except getopt.GetoptError, exc:
    sys.stderr.write(sys.argv[0] + ": " + exc.msg + "\n")
    sys.exit(2)

for o, a in opts:
    if o in ("-f", "--file"):
        file = a
        
    if o in ("-l", "--layers"):
        layers = int(a)
        
    if o in ("-p", "--pictures"):
        pictures = int(a)
        
    if o in ("-t", "--temporal_levels"):
        temporal_levels = int(a)
        
    if o in ("-h", "--help"):
	usage()
	sys.exit()

command = "kdu_v_expand" + " -i " + file + ".mjc" + " -o " + file + ".vix" + " -layers " + str(layers)

os.system(command + " > /dev/null")


command = "mctf vix2raw < " + file + ".vix > " + file



# Eliminamos la cabecera .vix
os.system(command)
